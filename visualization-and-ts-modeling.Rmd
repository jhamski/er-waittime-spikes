---
title: "R Notebook"
output: html_notebook
---
```{r}
library(tidyverse)
library(anomalize)
library(tibbletime)
library(forecast)
```

Note timestamp is in UTC timezone. 
```{r}
er_wait_times <- read_csv("waittimes_record.csv")

realtime_hospital_list <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1MCiyFx-kC2Et88taXHt49x4W0PTJboJ93A-SmZ9Ed4Q/edit?usp=sharing")

er_wait_times <- er_wait_times %>% 
  left_join(realtime_hospital_list, by = "site_labels")
```


```{r}
er_wait_times %>% 
  filter(!is.na(State)) %>% 
  ggplot(aes(x = read_timestamp, y = total_minutes)) + 
  geom_point(aes(color = State)) +
  #geom_line(aes(color = hospital_webpage)) + 
  theme_minimal() +
  geom_smooth() 
```

```{r}

er_wait_times %>%
  filter(!is.na(State)) %>% 
  ggplot(aes(x = hospital_webpage, y = total_minutes)) +
  geom_boxplot() + 
  #stat_summary(fun.data = give.n, geom = "text", fun.y = median,
                  #position = position_dodge(width = 0.75)) +
  facet_wrap(~State, scales = "free_x") +
  theme_minimal() +
  ylab("Stated Wait Time (Minutes)") +
  xlab("")
```

